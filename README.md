```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                                                                            
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•
                                                                                            
                                                                                            
                      Pipeline de IntegraciÃ³n de Datos BioinformÃ¡ticos                      
                         GDC Â· HGNC Â· UniProt â†’ MongoDB / JSON                              
                                                                                            
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
- **DATOS GENERALES**
  - Proyecto:       BioIntegrate - Pipeline de IntegraciÃ³n de Datos BioinformÃ¡ticos
  - VersiÃ³n:        0.1.0
  - Asignatura:     EstÃ¡ndares de Datos
  - Universidad:    Universidad de MÃ¡laga (UMA)
  - Curso acadÃ©mico: 2024-2025
  - Repositorio:    https://github.com/MarioPasc/ProyectoEstandaresDatos

- **TUTOR ASIGNADO**
  - Nombre:         Dr.Rybinski, Maciej
  - Universidad:    Universidad de MÃ¡laga (UMA)

- **EQUIPO DE DESARROLLO**
  1. Mario Pascual-GonzÃ¡lez
     Email: mpascual@uma.es
     Rol:   Developer

  2. Teresa Vega MartÃ­nez
     Email: teresavegamar@gmail.com
     Rol:   Developer

  3. Juan Soriano
     Email: 0610948742@uma.es
     Rol:   Developer

  4. Ainhoa PÃ©rez
     Email: ainhoa140602@gmail.com
     Rol:   Developer

  5. Martina Cebolla Salas
     Email: martinacesalas@gmail.com
     Rol:   Developer

<!-- TOC start (generated with https://github.com/derlin/bitdowntoc) -->

# Tabla de Contenidos

- [Tabla de Contenidos](#tabla-de-contenidos)
- [BioIntegrate](#biointegrate)
  - [ğŸš€ InstalaciÃ³n y ConfiguraciÃ³n](#-instalaciÃ³n-y-configuraciÃ³n)
    - [1ï¸âƒ£ Clonar el repositorio](#1ï¸âƒ£-clonar-el-repositorio)
    - [2ï¸âƒ£ Cambiar a la rama de desarrollo](#2ï¸âƒ£-cambiar-a-la-rama-de-desarrollo)
    - [3ï¸âƒ£ Crear entorno Conda](#3ï¸âƒ£-crear-entorno-conda)
    - [4ï¸âƒ£ Instalar el paquete en modo desarrollo](#4ï¸âƒ£-instalar-el-paquete-en-modo-desarrollo)
    - [5ï¸âƒ£ Configurar rutas personales](#5ï¸âƒ£-configurar-rutas-personales)
  - [Quick Start](#quick-start)
  - [ğŸ“¥ Descargar Datos](#-descargar-datos)
  - [ğŸ—„ï¸ Importar a JSON y MongoDB](#ï¸-importar-a-json-y-mongodb)
  - [ğŸ“Š Fuentes de Datos](#-fuentes-de-datos)
  - [ğŸ”§ VerificaciÃ³n](#-verificaciÃ³n)
  - [ğŸ“– Lectura](#-lectura)
  - [â“ Problemas Comunes](#-problemas-comunes)

<!-- TOC end -->

<!-- TOC --><a name="proyectoestandaresdatos"></a>
# BioIntegrate
Repositorio Github para el proyecto final de la asignatura "EstÃ¡ndares de Datos"

<!-- TOC --><a name="-instalaciÃ³n-y-configuraciÃ³n"></a>
## ğŸš€ InstalaciÃ³n y ConfiguraciÃ³n

<!-- TOC --><a name="1-clonar-el-repositorio"></a>
### 1ï¸âƒ£ Clonar el repositorio

```bash
git clone https://github.com/MarioPasc/ProyectoEstandaresDatos.git
cd ProyectoEstandaresDatos
```

<!-- TOC --><a name="2-cambiar-a-la-rama-de-desarrollo"></a>
### 2ï¸âƒ£ Cambiar a la rama de desarrollo

> [!IMPORTANT]
> **DEBES** trabajar en la rama `dev` para tener acceso a las Ãºltimas funcionalidades de descarga de datos.

```bash
git checkout dev
```

<!-- TOC --><a name="3-crear-entorno-conda"></a>
### 3ï¸âƒ£ Crear entorno Conda

> [!WARNING]
> Se requiere **Python 3.9** especÃ­ficamente. No uses otras versiones.

```bash
conda create -n estandares python=3.9 -y
conda activate estandares
```

<!-- TOC --><a name="4-instalar-el-paquete-en-modo-desarrollo"></a>
### 4ï¸âƒ£ Instalar el paquete en modo desarrollo

```bash
pip install -e .
```

<!-- TOC --><a name="5-configurar-rutas-personales"></a>
### 5ï¸âƒ£ Configurar rutas personales

> [!CAUTION]
> **CRÃTICO**: Debes personalizar las rutas de salida antes de ejecutar descargas.

```bash
# Editar el archivo y cambiar TODAS las rutas que contienen /home/mpascual
# por tu ruta personal (ver config/README.md para detalles)
nano config/data/{tu nombre}_data_config.yaml  # o usa tu editor preferido
```

**Rutas que debes cambiar** (6 en total):
- âœï¸ `gdc.manifest_output`
- âœï¸ `gdc.file_metadata_output`
- âœï¸ `gdc.genes_output`
- âœï¸ `gdc.rnaseq.output_dir`
- âœï¸ `gdc.rnaseq.gene_table_output`
- âœï¸ `hgnc.output_path`
- âœï¸ `uniprot.mapping_output`
- âœï¸ `uniprot.metadata_output`

ğŸ“– **Consulta** `config/README.md` para instrucciones detalladas.

## Quick Start

Se puede ejecutar el pipeline completo con:

```bash
  # Pipeline completo
  biointegrate-pipeline \
    --data-config config/data/mario_data_config.yaml \
    --mongo-config config/db_mongo/mario_mongodb_config.yaml

  # Solo crear JSONs sin insertar en MongoDB
  biointegrate-pipeline \
    --data-config config/data/mario_data_config.yaml \
    --mongo-config config/db_mongo/mario_mongodb_config.yaml \
    --no-insert

  # Omitir descarga (datos ya existen)
  biointegrate-pipeline \
    --data-config config/data/mario_data_config.yaml \
    --mongo-config config/db_mongo/mario_mongodb_config.yaml \
    --skip-download

  # Sin confirmaciÃ³n (ejecuciÃ³n directa)
  biointegrate-pipeline \
    --data-config config/data/mario_data_config.yaml \
    --mongo-config config/db_mongo/mario_mongodb_config.yaml \
    --yes
```

En el ordenador de Mario Pascual GonzÃ¡lez:

```bash
====================================================================================================
PIPELINE COMPLETADO
====================================================================================================
  Estado:           EXITOSO
  Tiempo total:     2m 7s
  Descarga:         Ejecutada
  JSONs creados:    SÃ­
  MongoDB:          No (--no-insert)
  EvaluaciÃ³n:       Ejecutada

  Ficheros JSON generados:
    - GDC: /home/mpascual/misc/Universidad25-26/Estandares/data/gdc/gdc_collection_export.json
    - HGNC: /home/mpascual/misc/Universidad25-26/Estandares/data/hgnc/hgnc_collection_export.json
    - UniProt: /home/mpascual/misc/Universidad25-26/Estandares/data/uniprot/uniprot_collection_export.json
====================================================================================================
2025-11-22 09:51:27 - biointegrate.cli.pipeline - INFO - Pipeline completado exitosamente
```
<!-- TOC --><a name="-descargar-datos"></a>
## ğŸ“¥ Descargar Datos

Una vez configurado tu archivo `config/data_config.yaml`:

```bash
# Descargar TODOS los datos (GDC + HGNC + UniProt)
biointegrate-download --config config/data_config.yaml --source all

# O descargar fuentes individuales:
biointegrate-download --config config/data_config.yaml --source gdc
biointegrate-download --config config/data_config.yaml --source hgnc
biointegrate-download --config config/data_config.yaml --source uniprot
```

> [!NOTE]
> - La descarga completa puede tardar varios minutos
> - UniProt requiere que GDC y HGNC se hayan descargado primero
> - Los directorios de salida se crean automÃ¡ticamente

<!-- TOC --><a name="-importar-a-json-y-mongodb"></a>
## ğŸ—„ï¸ Importar a JSON y MongoDB

Una vez descargados los datos crudos, puedes procesarlos y convertirlos a formato JSON, y opcionalmente importarlos a MongoDB.

> [!CAUTION]
> **CRÃTICO**: Debes crear tu propio archivo de configuraciÃ³n de MongoDB.

```bash
# Crear tu archivo de configuraciÃ³n personalizado
cp config/db_mongo/mario_mongodb_config.yaml config/db_mongo/{tu_nombre}_mongodb_config.yaml

# Editar y cambiar TODAS las rutas que contienen /home/mpascual
nano config/db_mongo/{tu_nombre}_mongodb_config.yaml
```

**Comandos de importaciÃ³n:**

```bash
# Importar TODAS las fuentes (GDC + HGNC + UniProt) a JSON y MongoDB
biointegrate-import-all --config config/db_mongo/{tu_nombre}_mongodb_config.yaml

# Solo generar archivos JSON sin insertar en MongoDB
biointegrate-import-all --config config/db_mongo/{tu_nombre}_mongodb_config.yaml --no-insert

# Omitir fuentes especÃ­ficas durante la importaciÃ³n
biointegrate-import-all --config config/db_mongo/{tu_nombre}_mongodb_config.yaml --skip-gdc
biointegrate-import-all --config config/db_mongo/{tu_nombre}_mongodb_config.yaml --skip-hgnc
biointegrate-import-all --config config/db_mongo/{tu_nombre}_mongodb_config.yaml --skip-uniprot
```

**Resultado esperado:**

Tras la ejecuciÃ³n exitosa, se generarÃ¡n archivos JSON:
- âœ… **GDC**: ~7.6KB
- âœ… **HGNC**: ~139MB
- âœ… **UniProt**: ~5.8MB

> [!NOTE]
> - Los archivos JSON se generan incluso con `--no-insert`
> - La importaciÃ³n a MongoDB requiere tener MongoDB en ejecuciÃ³n
> - Los tres importadores (GDC, HGNC, UniProt) se ejecutan en secuencia

<!-- TOC --><a name="-ejecuciÃ³n-de-consultas-y-reportes-t2"></a>
## ğŸ” EjecuciÃ³n de Consultas y Reportes (T2)

El proyecto incluye un CLI dedicado para ejecutar consultas complejas sobre MongoDB y generar reportes transformados (JSON â†’ XML â†’ HTML).

### Comando Principal

```bash
biointegrate-execute-queries \
  --config config/queries/mario_queries.yaml \
  --queries docs/t2-queries/Query2Completa.txt,docs/t2-queries/Query1_LGG_UniProt.txt,docs/t2-queries/Query3_MembraneCancerCoverage.txt \
  --output-dir docs/t2-resultados \
  --xslt docs/xslt/biointegrate_report.xslt
```

### Flujo de Trabajo

1.  **Carga de ConfiguraciÃ³n**: Lee credenciales de MongoDB desde el YAML.
2.  **EjecuciÃ³n**: Procesa los ficheros de consulta (`.txt`) contra la base de datos.
3.  **TransformaciÃ³n (T2)**:
    *   Guarda resultados crudos en `json/`.
    *   Convierte a XML en `xml/`.
    *   Aplica XSLT para generar reportes visuales en `html/`.

### Consultas Incluidas

*   **Query 1 (LGG UniProt)**: ProteÃ³mica dirigida para Glioma de Bajo Grado.
*   **Query 2 (Completa)**: IntegraciÃ³n multi-Ã³mica (ClÃ­nica + GenÃ³mica + ProteÃ³mica).
*   **Query 3 (Cobertura)**: AnÃ¡lisis de disponibilidad de datos para proteÃ­nas de membrana en cÃ¡ncer.

Para mÃ¡s detalles tÃ©cnicos, consulta la [GuÃ­a de Lectura del CLI](docs/reports/guia_lectura_queries_cli.html).

<!-- TOC --><a name="-fuentes-de-datos"></a>
## ğŸ“Š Fuentes de Datos

- **GDC (Genomic Data Commons)**: Datos RNA-seq del proyecto TCGA-LGG
- **HGNC**: Nomenclatura completa de genes humanos
- **UniProt**: AnotaciÃ³n de proteÃ­nas asociadas a los genes del proyecto

<!-- TOC --><a name="-verificaciÃ³n"></a>
## ğŸ”§ VerificaciÃ³n

DespuÃ©s de la descarga, el sistema muestra automÃ¡ticamente:
- âœ… EstadÃ­sticas de archivos descargados
- âœ… NÃºmero de registros y columnas
- âœ… Validaciones de integridad

<!-- TOC --><a name="-lectura"></a>
## ğŸ“– Lectura

Por favor! Leed con detenimiento [este fichero](docs/reports/T1_README_Datos.md), describe todo lo que creo que deberÃ­amos de saber de los datos antes de empezar a trabajar con ellos 

<!-- TOC --><a name="-problemas-comunes"></a>
## â“ Problemas Comunes

**Error: "No such file or directory"**
â†’ Verifica que las rutas en `data_config.yaml` existan y tengas permisos de escritura

**Error: "Archivo requerido no encontrado"** (al descargar UniProt)
â†’ Descarga primero GDC y HGNC: `--source gdc` y `--source hgnc`

**Error: "Python version mismatch"**
â†’ AsegÃºrate de usar Python 3.9: `python --version`
