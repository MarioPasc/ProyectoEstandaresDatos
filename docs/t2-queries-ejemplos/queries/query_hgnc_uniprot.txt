{
  "name": "hgnc_uniprot_lookup",
  "collection": "hgnc_genes",
  "type": "aggregate",
  "pipeline": [
    {
      "$match": {
        "symbol": {"$in": ["TP53", "BRCA1", "EGFR"]}
      }
    },
    {
      "$unwind": "$uniprot_ids"
    },
    {
      "$lookup": {
        "from": "uniprot_entries",
        "localField": "uniprot_ids",
        "foreignField": "uniprot_id",
        "as": "uniprot_data"
      }
    },
    {
      "$project": {
        "_id": 0,
        "gene_symbol": "$symbol",
        "hgnc_id": 1,
        "uniprot_id": "$uniprot_ids",
        "protein_name": {"$arrayElemAt": ["$uniprot_data.protein.names", 0]},
        "protein_length": {"$arrayElemAt": ["$uniprot_data.protein.length", 0]}
      }
    }
  ]
}
